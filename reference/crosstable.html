<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Generating cross tables from database lists — crosstable • vegtable</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Generating cross tables from database lists — crosstable"><meta name="description" content="cross table is the most common format required by statistical packages
used to analyse vegetation data (e.g.
vegan).
You may use for convenience a formula as
'abundance ~ plot + species + ...'.
Additional variables used for rows (...) can be for instance the
layers.
For objects of class vegtable, the formula can also include
variables from the species list (for example AcceptedName, AuthorName)
or even taxon traits.
If required, tables already formatted as cross tables can be converted into
column-oriented tables by using the function cross2db()."><meta property="og:description" content="cross table is the most common format required by statistical packages
used to analyse vegetation data (e.g.
vegan).
You may use for convenience a formula as
'abundance ~ plot + species + ...'.
Additional variables used for rows (...) can be for instance the
layers.
For objects of class vegtable, the formula can also include
variables from the species list (for example AcceptedName, AuthorName)
or even taxon traits.
If required, tables already formatted as cross tables can be converted into
column-oriented tables by using the function cross2db()."><meta property="og:image" content="http://kamapu.github.io/vegtable/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">vegtable</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.10</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/kamapu/vegtable/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Generating cross tables from database lists</h1>
      <small class="dont-index">Source: <a href="https://github.com/kamapu/vegtable/blob/main/R/crosstable.R" class="external-link"><code>R/crosstable.R</code></a></small>
      <div class="d-none name"><code>crosstable.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>cross table is the most common format required by statistical packages
used to analyse vegetation data (e.g.
<a href="https://CRAN.R-project.org/package=vegan" class="external-link">vegan</a>).</p>
<p>You may use for convenience a formula as
<code>'abundance ~ plot + species + ...'</code>.
Additional variables used for rows (<code>...</code>) can be for instance the
layers.
For objects of class <a href="vegtable-class.html">vegtable</a>, the formula can also include
variables from the species list (for example <code>AcceptedName</code>, <code>AuthorName</code>)
or even taxon traits.</p>
<p>If required, tables already formatted as cross tables can be converted into
column-oriented tables by using the function <code>cross2db()</code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">crosstable</span><span class="op">(</span><span class="va">formula</span>, <span class="va">data</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'formula,data.frame'</span></span>
<span><span class="fu">crosstable</span><span class="op">(</span></span>
<span>  <span class="va">formula</span>,</span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">FUN</span>,</span>
<span>  na_to_zero <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  use_nas <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  as_matrix <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'formula,vegtable'</span></span>
<span><span class="fu">crosstable</span><span class="op">(</span></span>
<span>  <span class="va">formula</span>,</span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">FUN</span>,</span>
<span>  <span class="va">level</span>,</span>
<span>  include_lower <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  na_to_zero <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  use_nas <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">cross2db</span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'data.frame'</span></span>
<span><span class="fu">cross2db</span><span class="op">(</span><span class="va">object</span>, layers <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">na_strings</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'matrix'</span></span>
<span><span class="fu">cross2db</span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-formula">formula<a class="anchor" aria-label="anchor" href="#arg-formula"></a></dt>
<dd><p>A formula indicating the variables used in the cross table.
This formula can be represented as <code>'abundance ~ cols + rows'</code>, where
<code>'abundance'</code> is the numeric variable quantified for a row in a column,
for instance the abundance of a species in a plot.
Further variables can be set as additional rows indices in a cross table.</p></dd>


<dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>Either a data frame or an object of class <a href="vegtable-class.html">vegtable</a>.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Further arguments passed to the function <code><a href="https://rdrr.io/r/stats/aggregate.html" class="external-link">stats::aggregate()</a></code>.</p></dd>


<dt id="arg-fun">FUN<a class="anchor" aria-label="anchor" href="#arg-fun"></a></dt>
<dd><p>Function used to aggregate values in the case of a multiple
occurrence of a species in a plot, for instance.</p></dd>


<dt id="arg-na-to-zero">na_to_zero<a class="anchor" aria-label="anchor" href="#arg-na-to-zero"></a></dt>
<dd><p>A logical value indicating whether zeros should be
inserted into empty cells or not.</p></dd>


<dt id="arg-use-nas">use_nas<a class="anchor" aria-label="anchor" href="#arg-use-nas"></a></dt>
<dd><p>Logical value indicating whether NAs should be considered as
levels for categorical variables or not.</p></dd>


<dt id="arg-as-matrix">as_matrix<a class="anchor" aria-label="anchor" href="#arg-as-matrix"></a></dt>
<dd><p>A logical value, whether output should be done as matrix or
data frame.</p></dd>


<dt id="arg-level">level<a class="anchor" aria-label="anchor" href="#arg-level"></a></dt>
<dd><p>A character vector with taxonomic ranks (levels) requested in
the cross table.</p></dd>


<dt id="arg-include-lower">include_lower<a class="anchor" aria-label="anchor" href="#arg-include-lower"></a></dt>
<dd><p>A logical value indicating wether lower value to the
requested levels should be merged or not. It works only if <code>'level'</code> is
not missing. Note that if you like to include higher ranks or rankless
taxa in the cross table, you will rahter need to run
<code><a href="https://docs.ropensci.org/taxlist/reference/merge_taxa.html" class="external-link">taxlist::merge_taxa()</a></code> on slot <strong>species</strong>.</p></dd>


<dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p>A data frame or a matrix including a cross table. Note that
<code>cross2db()</code> assumes observations as columns and species (and layers)
as rows in the <code>data.frame-method</code> but species as columns and
observations as rows in the <code>matrix-method</code>.</p></dd>


<dt id="arg-layers">layers<a class="anchor" aria-label="anchor" href="#arg-layers"></a></dt>
<dd><p>Logical value, whether the cross table includes a layer column
or not.</p></dd>


<dt id="arg-na-strings">na_strings<a class="anchor" aria-label="anchor" href="#arg-na-strings"></a></dt>
<dd><p>Character vector indicating no records in the cross table.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An object of class <a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a>.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Miguel Alvarez <a href="mailto:kamapu78@gmail.com">kamapu78@gmail.com</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Produce a subset</span></span></span>
<span class="r-in"><span><span class="va">veg</span> <span class="op">&lt;-</span> <span class="fu"><a href="subset.html">subset</a></span><span class="op">(</span><span class="va">Kenya_veg</span>, <span class="va">REFERENCE</span> <span class="op">==</span> <span class="fl">2331</span>, slot <span class="op">=</span> <span class="st">"header"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## transform cover to percentage</span></span></span>
<span class="r-in"><span><span class="va">veg</span> <span class="op">&lt;-</span> <span class="fu"><a href="cover_trans.html">cover_trans</a></span><span class="op">(</span><span class="va">veg</span>, to <span class="op">=</span> <span class="st">"cover_perc"</span>, rule <span class="op">=</span> <span class="st">"middle"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## cross table of the first 5 plots</span></span></span>
<span class="r-in"><span><span class="va">Cross</span> <span class="op">&lt;-</span> <span class="fu">crosstable</span><span class="op">(</span><span class="va">cover_perc</span> <span class="op">~</span> <span class="va">ReleveID</span> <span class="op">+</span> <span class="va">AcceptedName</span> <span class="op">+</span> <span class="va">AuthorName</span>,</span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">veg</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="op">]</span>, FUN <span class="op">=</span> <span class="va">mean</span>, na_to_zero <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">Cross</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               AcceptedName                AuthorName 1940 1937 1938 1939 1941</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1      Commiphora africana          (A. Rich.) Engl.  0.5    0    0    0  0.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2     Eragrostis macilenta         (A. Rich.) Steud.  3.0    3    3    3  0.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3       Helinus mystacinus (Aiton) E. Mey. ex Steud.  0.0    0    0    0  3.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   Eragrostis cilianensis        (All.) F. T. Hubb.  3.0    3    3    3  3.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 Astripomoea lachnosperma        (Choisy) A. Meeuse  3.0    3    0    3  3.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6       Coccinia trilobata        (Cogn.) C. Jeffrey  3.0    0    3    3  0.5</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## cross table of recorded genera</span></span></span>
<span class="r-in"><span><span class="va">Cross</span> <span class="op">&lt;-</span> <span class="fu">crosstable</span><span class="op">(</span><span class="va">cover_perc</span> <span class="op">~</span> <span class="va">ReleveID</span> <span class="op">+</span> <span class="va">AcceptedName</span> <span class="op">+</span> <span class="va">AuthorName</span>,</span></span>
<span class="r-in"><span>    data <span class="op">=</span> <span class="va">veg</span>, FUN <span class="op">=</span> <span class="va">mean</span>, level <span class="op">=</span> <span class="st">"genus"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">Cross</span><span class="op">[</span> , <span class="fl">1</span><span class="op">:</span><span class="fl">7</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   AcceptedName       AuthorName 2005 2059 2061 2080 2102</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  Cyphostemma (Planch.) Alston  0.5  0.5  0.5  0.5  0.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  Cassipourea            Aubl.   NA   NA   NA   NA   NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3       Dregea          E. Mey.   NA   NA   NA   NA   NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4    Digitaria           Haller   NA   NA   NA   NA   NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 Chlorophytum        Ker Gawl.   NA   NA   NA   NA   NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 Plectranthus          L'HÃ©r.   NA   NA   NA   NA   NA</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## cross table of data merged to genus</span></span></span>
<span class="r-in"><span><span class="va">Cross</span> <span class="op">&lt;-</span> <span class="fu">crosstable</span><span class="op">(</span><span class="va">cover_perc</span> <span class="op">~</span> <span class="va">ReleveID</span> <span class="op">+</span> <span class="va">AcceptedName</span> <span class="op">+</span> <span class="va">AuthorName</span>,</span></span>
<span class="r-in"><span>    data <span class="op">=</span> <span class="va">veg</span>, FUN <span class="op">=</span> <span class="va">sum</span>, level <span class="op">=</span> <span class="st">"genus"</span>, include_lower <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">Cross</span><span class="op">[</span> , <span class="fl">1</span><span class="op">:</span><span class="fl">7</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      AcceptedName                                 AuthorName 2008 2102 2112</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1       Bullockia      (Bridson) Razafim., Lantz &amp; B. Bremer  0.5   NA   NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2          Scutia                     (Comm. ex DC.) Brongn.   NA  0.5  0.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   Dichrostachys                         (DC.) Wight &amp; Arn.   NA   NA   NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 Lepidotrichilia (Harms) J.-F. Leroy ex T.D. Penn. &amp; Styles   NA   NA   NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5      Afrocarpus        (J. Buchholz &amp; E.G. Gray) C.N. Page   NA   NA   NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6        Leonotis                             (Pers.) R. Br.   NA   NA   NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   2121 2165</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   NA   NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  0.5    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   NA   NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 10.0   NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   NA   NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   NA   NA</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## the same for families</span></span></span>
<span class="r-in"><span><span class="va">Cross</span> <span class="op">&lt;-</span> <span class="fu">crosstable</span><span class="op">(</span><span class="va">cover_perc</span> <span class="op">~</span> <span class="va">ReleveID</span> <span class="op">+</span> <span class="va">AcceptedName</span> <span class="op">+</span> <span class="va">AuthorName</span>,</span></span>
<span class="r-in"><span>    data <span class="op">=</span> <span class="va">veg</span>, FUN <span class="op">=</span> <span class="va">sum</span>, level <span class="op">=</span> <span class="st">"family"</span>, include_lower <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">Cross</span><span class="op">[</span> , <span class="fl">1</span><span class="op">:</span><span class="fl">7</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     AcceptedName       AuthorName 1966 1980 1988 2005 2010</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 Passifloraceae Juss. ex Roussel  0.5  0.5  0.5  0.5  0.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2    Acanthaceae               NA   NA 22.0 10.0  0.5 19.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3    Achariaceae               NA   NA   NA   NA   NA   NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4      Aizoaceae               NA   NA   NA   NA  3.0   NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  Amaranthaceae               NA  3.0   NA 19.0 36.0  3.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 Amaryllidaceae               NA   NA   NA   NA   NA   NA</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Miguel Alvarez.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

